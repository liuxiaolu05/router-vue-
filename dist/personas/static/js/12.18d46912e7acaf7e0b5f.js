webpackJsonp([12],{CT32:function(t,e,a){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var l=a("fkWs"),n=i(l),r=a("h6Al"),o=i(r);e.default={data:function(){return{columns:[],dataTable:[],villageTitle:"",imgSrc:"",old:!1,longtitude:null,latitude:null,clearVal:!0,common:[],older:[{title:"近期成交",key:"recent_volume"},{title:"竣工时间",key:"complete_time"},{title:"建筑年代",key:"year_built"},{title:"物业类型",key:"property_type"},{title:"当期户数",key:"current_households"}],newer:[{title:"装修状况",key:"decoration_status"},{title:"开盘时间",key:"opening_quotation_time"},{title:"交房时间",key:"others_time"},{title:"主力户型",key:"main_apartment"}],mapVal:{tipVal:"",tipNearbyVal:"",placeSearch:null,centerPoint:null,near:!0,map:null,name:"",lo:!1},defaultImgSrc:o.default,defaultShowImg:'this.src="'+o.default+'"',backText:"返回小区列表"}},methods:{getTableData:function(){var t,e=this,a=this.$route.query.id,i=this.$route.query.type;e.common=[{title:"楼盘地址",key:"community_address"},{title:"小区均价",key:"avg_priceint"},{title:"物业类别",key:"property_category"},{title:"物业公司",key:"property_company_name"},{title:"总户数",key:"sum_households"},{title:"覆盖会员数",key:"gome_member_num"},{title:"会员覆盖率",key:"gome_member_cover"},{title:"近7日销售额",key:"gome_sale_7day"},{title:"营销价值评分",key:"score"}],"1"==i?(e.old=!1,e.columns=e.common.concat(e.newer)):(e.old=!0,e.columns=e.common.concat(e.older)),axios.get(getUrl("villageDetail"),{params:{id:a},loading:!0,unload:!0}).then(function(a){if(a.detail){t=a.detail,e.imgSrc=t.picture?t.picture:e.defaultImgSrc,e.villageTitle=t.community_name,e.longtitude=t.longtitude,e.latitude=t.latitude,e.mapVal.centerPoint=[e.longtitude,e.latitude];var i,l,n,r=["暂无资料","待定","没有物业","无物业公司",null,""];e.columns.forEach(function(e,a){"property_company_name"!=e.key||r.selfContains(t[e.key])?"avg_priceint"==e.key||"sum_households"==e.key||"current_households"==e.key||"gome_member_num"==e.key?(n=parseInt(t[e.key]),e.val=""==e.key?"0":comUtils.toThousands(n)):"gome_sale_7day"==e.key&&t[e.key]>0?(i=parseFloat(t[e.key]).toFixed(2).split("."),l=comUtils.toThousands(i[0]),e.val=l+"."+i[1]):"score"==e.key&&t[e.key]>0?e.val=(100*t[e.key]).toFixed(2):"gome_member_cover"==e.key&&t[e.key]>0?e.val=(100*t[e.key]).toFixed(2)+"%":e.val=""==e.key?"":t[e.key]:e.val="<a class='property-link' data-action='property'  data-id='"+t.property_id+"'>"+t[e.key]+"</a>"}),e.centerPointerFn()}else e.imgSrc=e.defaultImgSrc}).catch(function(t){e.imgSrc=e.defaultImgSrc})},back:function(){this.$store.state.path="main",this.$router.push("/village/villageOverview.html")},toProperty:function(t){this.$store.state.path="sub",this.$router.push({path:"/property/property-information.html/propertyDetail",query:{id:t,reset:1}})},search:function(){var t=this;$.trim(t.mapVal.tipVal)&&t.mapVal.placeSearch.search(t.mapVal.tipVal)},nearby:function(){var t=this;$.trim(t.mapVal.tipNearbyVal)&&t.mapVal.placeSearch.searchNearBy(t.mapVal.tipNearbyVal,t.mapVal.centerPoint,2e3,function(t,e){}),t.mapVal.lo=!1,t.clearVal=!0},clear:function(){this.mapVal.placeSearch.clear()},change:function(){this.mapVal.near=!1,setTimeout(function(){document.getElementById("nearInput").focus()},10)},clearCon:function(){this.mapVal.tipNearbyVal&&(this.mapVal.tipNearbyVal=""),this.clear()},closeNear:function(){this.mapVal.tipNearbyVal="",this.clear()},centerPointerFn:function(){var t,e,a,i=this;e=[i.longtitude,i.latitude],i.mapVal.map.setZoomAndCenter(11,e),t=new AMap.LngLat(i.longtitude,i.latitude),a=new AMap.Marker({icon:"http://webapi.amap.com/theme/v1.3/markers/n/mark_r.png",position:t,map:i.mapVal.map}),a.on("click",i.centerPointerMarker),a.emit("click",{target:a}),i.mapVal.map.setFitView()},centerPointerMarker:function(t){var e,a=this,i="<div><p><strong>小区名称</strong></p><p>"+a.villageTitle+"</p></div>";e=new AMap.InfoWindow({offset:new AMap.Pixel(0,-28),content:i}),e.open(a.mapVal.map,t.target.getPosition()),a.mapVal.map.setFitView()}},mounted:function(){var t=this;t.getTableData(),(0,n.default)(function(){t.mapVal.map=new AMap.Map("details-map",{resizeEnable:!0,zoom:11}),AMap.service(["AMap.PlaceSearch"],function(){t.mapVal.placeSearch=new AMap.PlaceSearch({pageSize:5,pageIndex:1,map:t.mapVal.map,panel:"panel"}),t.mapVal.placeSearch.on("listElementClick",function(e){var a=e.data,i=a.location;t.mapVal.map.setZoomAndCenter(11,[i.lng,i.lat])})})}),$(document).on("click","a[data-action=property]",function(e){var a=$(this).data("id");t.toProperty(a)})}}},"P+4H":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("CT32"),l=a.n(i);for(var n in i)"default"!==n&&function(t){a.d(e,t,function(){return i[t]})}(n);var r=a("n9Cc"),o=a("VU/8"),s=o(l.a,r.a,!1,null,null,null);e.default=s.exports},fkWs:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){if(window.AMap)t();else{var e=document.createElement("script");e.src="/personas/static/lib/map.js",document.body.appendChild(e),setTimeout(function(){t()},1e3)}}},h6Al:function(t,e,a){t.exports=a.p+"static/img/loser.52dcea0.jpg"},n9Cc:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"details",attrs:{id:"details"}},[a("div",{staticClass:"top-title title-box  box-bot"},[a("div",{staticClass:" title"},[a("div",{staticClass:"i-pull-left title-name"},[a("span",{domProps:{textContent:t._s(t.villageTitle)}})]),t._v(" "),a("div",{staticClass:"i-pull-right"},[a("Button",{attrs:{type:"primary"},on:{click:t.back}},[t._v(t._s(t.backText))])],1)]),t._v(" "),a("div",{staticClass:"top-details box-content i-pull-clear"},[a("div",{staticClass:"img i-pull-left",class:{old:t.old}},[a("img",{attrs:{src:t.imgSrc,onerror:t.defaultShowImg,alt:"详情页"}})]),t._v(" "),a("div",{staticClass:"details-table i-pull-right"},t._l(t.columns,function(e){return a("div",{staticClass:"detail-con i-pull-clear"},[a("div",{staticClass:"de-title",domProps:{textContent:t._s(e.title)}}),t._v(" "),a("div",{staticClass:"de-val",domProps:{innerHTML:t._s(e.val)}})])}))])]),t._v(" "),a("div",{staticClass:"perimeter title-box"},[t._m(0),t._v(" "),a("div",{staticClass:"perimeter-map box-content"},[a("div",{staticClass:"details-map",attrs:{id:"details-map"}}),t._v(" "),t._m(1),t._v(" "),a("div",{staticClass:"search"},[a("div",{staticClass:"nearby"},[t._v("\n                    在"),a("span",{staticClass:"tip-val-left",domProps:{textContent:t._s(t.villageTitle)}}),t._v("附近搜索\n                    "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.mapVal.tipNearbyVal,expression:"mapVal.tipNearbyVal"}],attrs:{id:"nearInput",type:"text",placeholder:""},domProps:{value:t.mapVal.tipNearbyVal},on:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.nearby(e)},input:function(e){e.target.composing||t.$set(t.mapVal,"tipNearbyVal",e.target.value)}}}),t._v(" "),a("span",{staticClass:"btn-search",on:{click:t.nearby}},[a("Icon",{attrs:{type:"ios-search-strong"}})],1),t._v(" "),a("Tooltip",{staticClass:"backTip",attrs:{content:"清空附近搜索",placement:"bottom"}},[a("span",{on:{click:t.closeNear}},[a("Icon",{attrs:{type:"ios-close-empty"}})],1)])],1)])])])])},l=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"title"},[a("div",{staticClass:"perimeter-t box-bot"},[t._v("查看周边")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"panel"},[a("div",{attrs:{id:"panel"}})])}],n={render:i,staticRenderFns:l};e.a=n}});
//# sourceMappingURL=12.18d46912e7acaf7e0b5f.js.map