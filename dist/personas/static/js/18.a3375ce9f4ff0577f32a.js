webpackJsonp([18],{m9R0:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("7+uW");!function(e){e&&e.__esModule}(i);t.default={data:function(){var e=function(e,t,a){""==t[1]?a(new Error("推送日期不能为空")):a()},t=function(e,t,a){var i=/【(.+?)】/g,r=i.exec(t);r&&(r[1].length>12||r[1].length<2)?a(new Error("请输入2-12个汉字以内的签名")):a()};return{crowdList:[],orglist:[],open:!1,editData:{eventName:"",eventType:"0",dateRange:[],pushBegainDate:null,pushEndDate:null,pushTime:1,crowdIds:[],createUser:top.$.cookie("username"),crowdName:[],crowdNames:null,content:""},ruleValidate:{eventName:[{required:!0,message:"活动名称不能为空",trigger:"blur"}],dateRange:[{validator:e,trigger:"change"}],crowdName:[{required:!0,type:"array",message:"请选择人群",trigger:"change"},{type:"array",max:5,message:"最多可以选择5个人群",trigger:"change"}],pushTime:[{required:!0,type:"number",message:"请选择推送时间",trigger:"change"}],content:[{required:!0,type:"string",message:"短信内容不能为空",trigger:"blur"},{type:"string",max:500,message:"最多可以输入500个字符",trigger:"blur"},{validator:t,trigger:"blur"}]},options:{dateRange:{disabledDate:function(e){return e<DateFormat.convert(DateFormat().toDate(1),"YMD")}}}}},watch:{"editData.dateRange":function(){var e=this.editData.dateRange||[];this.editData.pushBegainDate=DateFormat(e[0]).toString("yyyy-MM-dd"),this.editData.pushEndDate=DateFormat(e[1]).toString("yyyy-MM-dd")}},computed:{channels:function(){return this.$store.state.messagechannels}},methods:{backToList:function(){this.$store.state.path="main",this.$router.push("/market/marketList.html")},getCrowdList:function(){var e=this,t=this.editData.pushBegainDate,a=this.editData.pushEndDate;axios.get(getUrl("marketEvent/getCrowdName"),{params:{crowdName:this.crowdName,pushBegainDate:t,pushEndDate:a}}).then(function(t){0==t.code?e.crowdList=t.crowdInfoList:e.crowdList.crowdList=[]}).catch(function(e){})},timeOk:function(){this.getCrowdList(),this.open=!1},timeChange:function(){$("#picker .ivu-picker-confirm").find(".ivu-btn-primary").attr("disabled",!1)},selectCrowd:function(e){e.length>5&&(this.editData.crowdIds=e.slice(0,5))},save:function(){var e=this;this.$refs.editData.validate(function(t){t?(e.editData.crowdIds=e.editData.crowdIds.join(","),e.editData.crowdNames=e.editData.crowdName.join(","),axios.post(getUrl("marketEvent/saveMarketEvent"),e.editData).then(function(t){0==t.code&&(e.$Message.success("操作成功"),e.backToList(),e.$parent.reload())})):e.$Message.warning("操作失败")})}},mounted:function(){var e=this;$("#picker .ivu-input-wrapper").on("click",function(){e.open=!0,$("#picker .ivu-picker-confirm").find(".ivu-btn-primary").attr("disabled",!0)})}}},mOn7:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("m9R0"),r=a.n(i);for(var n in i)"default"!==n&&function(e){a.d(t,e,function(){return i[e]})}(n);var s=a("xbTj"),o=a("VU/8"),d=o(r.a,s.a,!1,null,null,null);t.default=d.exports},xbTj:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"new-add"},[a("Form",{ref:"editData",attrs:{model:e.editData,rules:e.ruleValidate,"label-width":120}},[a("div",{staticClass:"panel panel-default"},[a("Card",{attrs:{"dis-hover":""}},[a("p",{attrs:{slot:"title"},slot:"title"},[e._v("创建营销活动")]),e._v(" "),a("FormItem",{attrs:{label:"活动名称",prop:"eventName"}},[a("div",{staticClass:"groups"},[a("Input",{staticClass:"w-260",attrs:{type:"text",placeholder:"请输入活动名称"},model:{value:e.editData.eventName,callback:function(t){e.$set(e.editData,"eventName",t)},expression:"editData.eventName"}})],1)]),e._v(" "),a("FormItem",{attrs:{label:"活动类型"}},[a("div",{staticClass:"groups"},[a("RadioGroup",{model:{value:e.editData.eventType,callback:function(t){e.$set(e.editData,"eventType",t)},expression:"editData.eventType"}},e._l(e.channels,function(t){return a("Radio",{key:t.value,attrs:{label:t.value,disabled:""}},[e._v(e._s(t.label))])}))],1)]),e._v(" "),a("FormItem",{attrs:{label:"推送日期",prop:"dateRange"}},[a("div",{staticClass:"groups",attrs:{id:"tip-date"}},[a("DatePicker",{attrs:{id:"picker",confirm:"",format:"yyyy.MM.dd",options:e.options.dateRange,type:"daterange",placeholder:"请选择日期",open:e.open},on:{"on-ok":e.timeOk,"on-clear":function(t){e.open=!1},"on-change":e.timeChange},model:{value:e.editData.dateRange,callback:function(t){e.$set(e.editData,"dateRange",t)},expression:"editData.dateRange"}})],1)]),e._v(" "),a("FormItem",{attrs:{label:"选择人群",prop:"crowdName"}},[a("div",{staticClass:"groups"},[a("selection",{attrs:{placeholder:"请选择人群","filter-placeholder":"请输入人群名称",value:e.crowdList,multiple:!0,clearable:"","value-field":"crowdId","label-field":"crowdName","label-model":"editData.crowdName",context:this},on:{"on-change":e.selectCrowd},model:{value:e.editData.crowdIds,callback:function(t){e.$set(e.editData,"crowdIds",t)},expression:"editData.crowdIds"}})],1)]),e._v(" "),a("FormItem",{attrs:{label:"推送时间",prop:"pushTime"}},[a("div",{staticClass:"groups"},[a("span",[e._v("每日定时")]),e._v(" "),a("Select",{model:{value:e.editData.pushTime,callback:function(t){e.$set(e.editData,"pushTime",t)},expression:"editData.pushTime"}},e._l(17,function(t,i){return a("Option",{key:i,attrs:{value:i},domProps:{textContent:e._s(i+8+"点")}})}))],1)]),e._v(" "),a("FormItem",{attrs:{label:"短信内容",prop:"content"}},[a("div",{staticClass:"groups"},[a("Input",{staticClass:"message",attrs:{type:"textarea",autosize:{minRows:4},placeholder:"请编辑短信内容....."},model:{value:e.editData.content,callback:function(t){e.$set(e.editData,"content",t)},expression:"editData.content"}})],1)])],1),e._v(" "),a("div",{staticClass:"groups"},[a("Button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("保存")]),e._v(" "),a("Button",{attrs:{type:"primary"},on:{click:e.backToList}},[e._v("取消")])],1)],1)])],1)},r=[],n={render:i,staticRenderFns:r};t.a=n}});
//# sourceMappingURL=18.a3375ce9f4ff0577f32a.js.map