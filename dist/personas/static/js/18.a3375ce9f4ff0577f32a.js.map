{"version":3,"sources":["webpack:///static/js/18.a3375ce9f4ff0577f32a.js","webpack:///src/pages/market/Add.vue","webpack:///./src/pages/market/Add.vue","webpack:///./src/pages/market/Add.vue?0ff1"],"names":["webpackJsonp","m9R0","module","exports","__webpack_require__","Object","defineProperty","value","_vue","obj","__esModule","default","data","validateDate","rule","callback","Error","validategrapha","reg","m","exec","length","crowdList","orglist","open","editData","eventName","eventType","dateRange","pushBegainDate","pushEndDate","pushTime","crowdIds","createUser","top","$","cookie","crowdName","crowdNames","content","ruleValidate","required","message","trigger","validator","type","max","options","disabledDate","d","DateFormat","convert","toDate","watch","editData.dateRange","this","toString","computed","channels","$store","state","messagechannels","methods","backToList","path","$router","push","getCrowdList","_vm","beginDate","endDate","axios","get","getUrl","params","then","res","code","crowdInfoList","catch","err","timeOk","timeChange","find","attr","selectCrowd","e","slice","save","$refs","validate","valid","join","post","$Message","success","$parent","reload","warning","mounted","vm","on","mOn7","__webpack_exports__","__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_node_modules_iview_loader_index_js_ref_0_1_Add_vue__","__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_node_modules_iview_loader_index_js_ref_0_1_Add_vue___default","n","__WEBPACK_IMPORT_KEY__","key","__WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_bd404f00_hasScoped_false_transformToRequire_video_src_source_src_img_src_image_xlink_href_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_node_modules_iview_loader_index_js_ref_0_1_Add_vue__","normalizeComponent","Component","a","xbTj","render","_h","$createElement","_c","_self","staticClass","ref","attrs","model","rules","label-width","dis-hover","slot","_v","label","prop","placeholder","$$v","$set","expression","_l","item","disabled","_s","id","confirm","format","on-ok","on-clear","$event","on-change","filter-placeholder","multiple","clearable","value-field","label-field","label-model","context","idx","domProps","textContent","autosize","minRows","click","staticRenderFns","esExports"],"mappings":"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","file":"static/js/18.a3375ce9f4ff0577f32a.js","sourcesContent":["webpackJsonp([18],{\n\n/***/ \"m9R0\":\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _vue = __webpack_require__(\"7+uW\");\n\nvar _vue2 = _interopRequireDefault(_vue);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n//    import Selection from \"@@/components/selection\"\n//    // 树组件\n//    Vue.component(Selection.name, Selection);\nexports.default = {\n    data: function data() {\n        var validateDate = function validateDate(rule, value, callback) {\n            if (value[1] == '') {\n                callback(new Error('推送日期不能为空'));\n            } else {\n                callback();\n            }\n        };\n        var validategrapha = function validategrapha(rule, value, callback) {\n            var reg = /【(.+?)】/g;\n            var m = reg.exec(value);\n            if (m && (m[1].length > 12 || m[1].length < 2)) {\n                callback(new Error('请输入2-12个汉字以内的签名'));\n            } else {\n                callback();\n            }\n        };\n        return {\n            crowdList: [], //人群下拉\n            orglist: [], //机构下拉\n            open: false,\n            editData: {\n                eventName: '', //活动名称\n                eventType: '0', //活动类型\n                dateRange: [], //推送周期\n                pushBegainDate: null,\n                pushEndDate: null,\n                pushTime: 1, //推送时间\n                crowdIds: [], //人群id\n                createUser: top.$.cookie('username'), //登录用户\n                crowdName: [], //人群类型\n                crowdNames: null, //人群类型\n                //                    organ:null,  //组织机构\n                content: '' //短信内容\n            },\n            ruleValidate: {\n                eventName: [{ required: true, message: '活动名称不能为空', trigger: 'blur' }],\n                dateRange: [\n                //                        {required: true, type: 'array', message: '推送日期不能为空', trigger: 'change'},\n                { validator: validateDate, trigger: 'change' }],\n                crowdName: [{ required: true, type: 'array', message: '请选择人群', trigger: 'change' }, { type: 'array', max: 5, message: '最多可以选择5个人群', trigger: 'change' }],\n                pushTime: [{ required: true, type: 'number', message: '请选择推送时间', trigger: 'change' }],\n                content: [{ required: true, type: 'string', message: '短信内容不能为空', trigger: 'blur' }, { type: 'string', max: 500, message: '最多可以输入500个字符', trigger: 'blur' }, { validator: validategrapha, trigger: 'blur' }]\n            },\n            options: {\n                dateRange: {\n                    disabledDate: function disabledDate(d) {\n                        // 只能从t+1开始选择\n                        return d < DateFormat.convert(DateFormat().toDate(1), \"YMD\");\n                    }\n                }\n            }\n        };\n    },\n    watch: {\n        \"editData.dateRange\": function editDataDateRange() {\n            var dateRange = this.editData.dateRange || [];\n            this.editData.pushBegainDate = DateFormat(dateRange[0]).toString(\"yyyy-MM-dd\");\n            this.editData.pushEndDate = DateFormat(dateRange[1]).toString(\"yyyy-MM-dd\");\n        }\n\n    },\n    computed: {\n        channels: function channels() {\n            return this.$store.state.messagechannels;\n        }\n    },\n    methods: {\n        backToList: function backToList() {\n            this.$store.state.path = 'main';\n            this.$router.push(\"/market/marketList.html\");\n        },\n        getCrowdList: function getCrowdList() {\n            var _vm = this,\n                beginDate = this.editData.pushBegainDate,\n                endDate = this.editData.pushEndDate;\n            axios.get(getUrl(\"marketEvent/getCrowdName\"), { params: { crowdName: this.crowdName, pushBegainDate: beginDate, pushEndDate: endDate } }).then(function (res) {\n                if (res.code == 0) {\n                    _vm.crowdList = res.crowdInfoList;\n                } else {\n                    _vm.crowdList.crowdList = [];\n                }\n            }).catch(function (err) {\n                console.log(err);\n            });\n        },\n        timeOk: function timeOk() {\n            this.getCrowdList();\n            this.open = false;\n        },\n        timeChange: function timeChange() {\n            $('#picker .ivu-picker-confirm').find('.ivu-btn-primary').attr('disabled', false);\n        },\n        selectCrowd: function selectCrowd(e) {\n            if (e.length > 5) {\n                this.editData.crowdIds = e.slice(0, 5);\n            }\n        },\n        save: function save() {\n            var _vm = this;\n            this.$refs['editData'].validate(function (valid) {\n                if (valid) {\n                    _vm.editData.crowdIds = _vm.editData.crowdIds.join(',');\n                    _vm.editData.crowdNames = _vm.editData.crowdName.join(',');\n                    axios.post(getUrl(\"marketEvent/saveMarketEvent\"), _vm.editData).then(function (data) {\n                        if (data.code == 0) {\n                            _vm.$Message.success(\"操作成功\");\n                            _vm.backToList();\n                            _vm.$parent.reload();\n                        }\n                    });\n                } else {\n                    _vm.$Message.warning(\"操作失败\");\n                }\n            });\n        }\n    },\n    mounted: function mounted() {\n        var vm = this;\n        // this.getCrowdList();\n        $('#picker .ivu-input-wrapper').on('click', function () {\n            vm.open = true;\n            $('#picker .ivu-picker-confirm').find('.ivu-btn-primary').attr('disabled', true);\n        });\n    }\n}; //\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n/***/ }),\n\n/***/ \"mOn7\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_node_modules_iview_loader_index_js_ref_0_1_Add_vue__ = __webpack_require__(\"m9R0\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_node_modules_iview_loader_index_js_ref_0_1_Add_vue___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_node_modules_iview_loader_index_js_ref_0_1_Add_vue__);\n/* harmony namespace reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_node_modules_iview_loader_index_js_ref_0_1_Add_vue__) if(__WEBPACK_IMPORT_KEY__ !== 'default') (function(key) { __webpack_require__.d(__webpack_exports__, key, function() { return __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_node_modules_iview_loader_index_js_ref_0_1_Add_vue__[key]; }) }(__WEBPACK_IMPORT_KEY__));\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_bd404f00_hasScoped_false_transformToRequire_video_src_source_src_img_src_image_xlink_href_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_node_modules_iview_loader_index_js_ref_0_1_Add_vue__ = __webpack_require__(\"xbTj\");\nvar normalizeComponent = __webpack_require__(\"VU/8\")\n/* script */\n\n\n/* template */\n\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = null\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_node_modules_iview_loader_index_js_ref_0_1_Add_vue___default.a,\n  __WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_bd404f00_hasScoped_false_transformToRequire_video_src_source_src_img_src_image_xlink_href_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_node_modules_iview_loader_index_js_ref_0_1_Add_vue__[\"a\" /* default */],\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (Component.exports);\n\n\n/***/ }),\n\n/***/ \"xbTj\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nvar render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"new-add\"},[_c('Form',{ref:\"editData\",attrs:{\"model\":_vm.editData,\"rules\":_vm.ruleValidate,\"label-width\":120}},[_c('div',{staticClass:\"panel panel-default\"},[_c('Card',{attrs:{\"dis-hover\":\"\"}},[_c('p',{attrs:{\"slot\":\"title\"},slot:\"title\"},[_vm._v(\"创建营销活动\")]),_vm._v(\" \"),_c('FormItem',{attrs:{\"label\":\"活动名称\",\"prop\":\"eventName\"}},[_c('div',{staticClass:\"groups\"},[_c('Input',{staticClass:\"w-260\",attrs:{\"type\":\"text\",\"placeholder\":\"请输入活动名称\"},model:{value:(_vm.editData.eventName),callback:function ($$v) {_vm.$set(_vm.editData, \"eventName\", $$v)},expression:\"editData.eventName\"}})],1)]),_vm._v(\" \"),_c('FormItem',{attrs:{\"label\":\"活动类型\"}},[_c('div',{staticClass:\"groups\"},[_c('RadioGroup',{model:{value:(_vm.editData.eventType),callback:function ($$v) {_vm.$set(_vm.editData, \"eventType\", $$v)},expression:\"editData.eventType\"}},_vm._l((_vm.channels),function(item){return _c('Radio',{key:item.value,attrs:{\"label\":item.value,\"disabled\":\"\"}},[_vm._v(_vm._s(item.label))])}))],1)]),_vm._v(\" \"),_c('FormItem',{attrs:{\"label\":\"推送日期\",\"prop\":\"dateRange\"}},[_c('div',{staticClass:\"groups\",attrs:{\"id\":\"tip-date\"}},[_c('DatePicker',{attrs:{\"id\":\"picker\",\"confirm\":\"\",\"format\":\"yyyy.MM.dd\",\"options\":_vm.options.dateRange,\"type\":\"daterange\",\"placeholder\":\"请选择日期\",\"open\":_vm.open},on:{\"on-ok\":_vm.timeOk,\"on-clear\":function($event){_vm.open=false},\"on-change\":_vm.timeChange},model:{value:(_vm.editData.dateRange),callback:function ($$v) {_vm.$set(_vm.editData, \"dateRange\", $$v)},expression:\"editData.dateRange\"}})],1)]),_vm._v(\" \"),_c('FormItem',{attrs:{\"label\":\"选择人群\",\"prop\":\"crowdName\"}},[_c('div',{staticClass:\"groups\"},[_c('selection',{attrs:{\"placeholder\":\"请选择人群\",\"filter-placeholder\":\"请输入人群名称\",\"value\":_vm.crowdList,\"multiple\":true,\"clearable\":\"\",\"value-field\":\"crowdId\",\"label-field\":\"crowdName\",\"label-model\":\"editData.crowdName\",\"context\":this},on:{\"on-change\":_vm.selectCrowd},model:{value:(_vm.editData.crowdIds),callback:function ($$v) {_vm.$set(_vm.editData, \"crowdIds\", $$v)},expression:\"editData.crowdIds\"}})],1)]),_vm._v(\" \"),_c('FormItem',{attrs:{\"label\":\"推送时间\",\"prop\":\"pushTime\"}},[_c('div',{staticClass:\"groups\"},[_c('span',[_vm._v(\"每日定时\")]),_vm._v(\" \"),_c('Select',{model:{value:(_vm.editData.pushTime),callback:function ($$v) {_vm.$set(_vm.editData, \"pushTime\", $$v)},expression:\"editData.pushTime\"}},_vm._l((17),function(item,idx){return _c('Option',{key:idx,attrs:{\"value\":idx},domProps:{\"textContent\":_vm._s(idx+8+'点')}})}))],1)]),_vm._v(\" \"),_c('FormItem',{attrs:{\"label\":\"短信内容\",\"prop\":\"content\"}},[_c('div',{staticClass:\"groups\"},[_c('Input',{staticClass:\"message\",attrs:{\"type\":\"textarea\",\"autosize\":{minRows: 4},\"placeholder\":\"请编辑短信内容.....\"},model:{value:(_vm.editData.content),callback:function ($$v) {_vm.$set(_vm.editData, \"content\", $$v)},expression:\"editData.content\"}})],1)])],1),_vm._v(\" \"),_c('div',{staticClass:\"groups\"},[_c('Button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.save}},[_vm._v(\"保存\")]),_vm._v(\" \"),_c('Button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.backToList}},[_vm._v(\"取消\")])],1)],1)])],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\n/* harmony default export */ __webpack_exports__[\"a\"] = (esExports);\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// static/js/18.a3375ce9f4ff0577f32a.js","<template id=\"add-temp\">\r\n    <div class=\"new-add\">\r\n        <Form ref=\"editData\" :model=\"editData\" :rules=\"ruleValidate\" :label-width=\"120\">\r\n            <div class=\"panel panel-default\">\r\n                <Card dis-hover>\r\n                    <p slot=\"title\">创建营销活动</p>\r\n                    <FormItem label=\"活动名称\" prop=\"eventName\">\r\n                        <div class=\"groups\">\r\n                            <Input type=\"text\" class=\"w-260\" v-model=\"editData.eventName\" placeholder=\"请输入活动名称\"/>\r\n                        </div>\r\n                    </FormItem>\r\n                    <FormItem label=\"活动类型\">\r\n                        <div class=\"groups\">\r\n                            <RadioGroup v-model=\"editData.eventType\">\r\n                                <Radio v-for=\"item in channels\" :label=\"item.value\" disabled :key=\"item.value\">{{item.label}}</Radio>\r\n                            </RadioGroup>\r\n                        </div>\r\n                    </FormItem>\r\n                    <FormItem label=\"推送日期\" prop=\"dateRange\">\r\n                        <div class=\"groups\" id=\"tip-date\">\r\n                            <DatePicker  id=\"picker\" v-model=\"editData.dateRange\"  confirm\r\n                                         format=\"yyyy.MM.dd\" :options=\"options.dateRange\"\r\n                                         type=\"daterange\"  placeholder=\"请选择日期\"\r\n                                         @on-ok=\"timeOk\"  @on-clear=\"open=false\" :open=\"open\"\r\n                                         @on-change=\"timeChange\">\r\n\r\n                            </DatePicker>\r\n                        </div>\r\n                    </FormItem>\r\n                    <FormItem label=\"选择人群\" prop=\"crowdName\">\r\n                        <div class=\"groups\">\r\n                            <!--<Select multiple clearable v-model=\"editData.crowdNames\" not-found-text=\"暂无数据\" @on-change=\"selectCrowd\">-->\r\n                                <!--<Option v-for=\"item in crowdList\" :value=\"item\" :key=\"item\">{{item}}</Option>-->\r\n                            <!--</Select>-->\r\n                            <selection  placeholder=\"请选择人群\" filter-placeholder=\"请输入人群名称\"\r\n                                       v-model=\"editData.crowdIds\" :value=\"crowdList\" :multiple=\"true\" clearable\r\n                                       value-field=\"crowdId\"  label-field=\"crowdName\"\r\n                                       label-model=\"editData.crowdName\" :context=\"this\" @on-change=\"selectCrowd\"\r\n                            ></selection>\r\n                        </div>\r\n                    </FormItem>\r\n                    <FormItem label=\"推送时间\" prop=\"pushTime\">\r\n                        <div class=\"groups\">\r\n                            <span>每日定时</span>\r\n                            <Select v-model=\"editData.pushTime\">\r\n                                <Option v-for=\"(item,idx) in 17\"  :value=\"idx\" :key=\"idx\"  v-text=\"idx+8+'点'\"></Option>\r\n                            </Select>\r\n                        </div>\r\n                    </FormItem>\r\n                    <!--<FormItem label=\"选择机构\" prop=\"organization\">-->\r\n                        <!--<div class=\"groups\">-->\r\n                            <!--<Select v-model=\"editData.organ\">-->\r\n                                <!--<Option v-for=\"item in orglist\" :value=\"item.value\" :key=\"item.value\">{{item.label}}</Option>-->\r\n                            <!--</Select>-->\r\n                        <!--</div>-->\r\n                    <!--</FormItem>-->\r\n                    <FormItem label=\"短信内容\" prop=\"content\">\r\n                        <div class=\"groups\">\r\n                            <Input  type=\"textarea\"  v-model=\"editData.content\" class=\"message\" :autosize=\"{minRows: 4}\" placeholder=\"请编辑短信内容.....\"></Input>\r\n                        </div>\r\n                    </FormItem>\r\n                </Card>\r\n                <div class=\"groups\">\r\n                    <Button type=\"primary\" @click=\"save\">保存</Button>\r\n                    <Button type=\"primary\" @click=\"backToList\">取消</Button>\r\n                </div>\r\n            </div>\r\n        </Form>\r\n    </div>\r\n</template>\r\n<script>\r\n    import Vue from \"vue\"\r\n//    import Selection from \"@@/components/selection\"\r\n//    // 树组件\r\n//    Vue.component(Selection.name, Selection);\r\n    export default {\r\n        data:function(){\r\n            const validateDate = (rule, value, callback) => {\r\n                if (value[1]=='') {\r\n                    callback(new Error('推送日期不能为空'));\r\n                } else {\r\n                    callback();\r\n                }\r\n            };\r\n            const validategrapha=(rule,value,callback)=>{\r\n                var reg=/【(.+?)】/g;\r\n                var m=reg.exec(value)\r\n                if(m && (m[1].length>12 || m[1].length<2)){\r\n                    callback(new Error('请输入2-12个汉字以内的签名'));\r\n                }else {\r\n                    callback();\r\n                }\r\n            }\r\n            return {\r\n                crowdList:[],//人群下拉\r\n                orglist:[], //机构下拉\r\n                open:false,\r\n                editData:{\r\n                    eventName:'', //活动名称\r\n                    eventType:'0', //活动类型\r\n                    dateRange:[], //推送周期\r\n                    pushBegainDate:null,\r\n                    pushEndDate:null,\r\n                    pushTime:1, //推送时间\r\n                    crowdIds:[],//人群id\r\n                    createUser:top.$.cookie('username'),//登录用户\r\n                    crowdName:[], //人群类型\r\n                    crowdNames:null, //人群类型\r\n//                    organ:null,  //组织机构\r\n                    content:'' //短信内容\r\n                },\r\n                ruleValidate:{\r\n                    eventName:[{ required: true, message: '活动名称不能为空', trigger: 'blur' }],\r\n                    dateRange: [\r\n//                        {required: true, type: 'array', message: '推送日期不能为空', trigger: 'change'},\r\n                          {validator: validateDate,  trigger: 'change'}\r\n                    ],\r\n                    crowdName:[\r\n                        {required: true, type: 'array', message: '请选择人群', trigger: 'change'},\r\n                        { type: 'array', max: 5, message: '最多可以选择5个人群', trigger: 'change' }\r\n                    ],\r\n                    pushTime:[\r\n                        {required: true, type:'number', message: '请选择推送时间', trigger: 'change'}\r\n                    ],\r\n                    content: [\r\n                        {required: true, type: 'string', message: '短信内容不能为空', trigger: 'blur'},\r\n                        { type: 'string', max: 500, message: '最多可以输入500个字符', trigger: 'blur' },\r\n                        { validator:validategrapha, trigger: 'blur' }\r\n                    ]\r\n                },\r\n                options: {\r\n                    dateRange: {\r\n                        disabledDate: function (d) { // 只能从t+1开始选择\r\n                            return d < DateFormat.convert(DateFormat().toDate(1), \"YMD\")\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        watch:{\r\n            \"editData.dateRange\": function () {\r\n                var dateRange = this.editData.dateRange || [];\r\n                this.editData.pushBegainDate = DateFormat(dateRange[0]).toString(\"yyyy-MM-dd\");\r\n                this.editData.pushEndDate = DateFormat(dateRange[1]).toString(\"yyyy-MM-dd\");\r\n            }\r\n\r\n        },\r\n        computed:{\r\n            channels: function () {\r\n                return this.$store.state.messagechannels;\r\n            }\r\n        },\r\n        methods:{\r\n            backToList:function(){\r\n                this.$store.state.path='main';\r\n                this.$router.push(\"/market/marketList.html\");\r\n            },\r\n            getCrowdList:function(){\r\n                var _vm=this,beginDate= this.editData.pushBegainDate,endDate=this.editData.pushEndDate;\r\n                axios.get(getUrl(\"marketEvent/getCrowdName\"),{params:{crowdName:this.crowdName,pushBegainDate:beginDate,pushEndDate:endDate}}).then(function(res){\r\n                    if(res.code==0){\r\n                        _vm.crowdList=res.crowdInfoList;\r\n                    }else {\r\n                        _vm.crowdList.crowdList=[]\r\n                    }\r\n                }).catch(function(err){\r\n                    console.log(err);\r\n                })\r\n            },\r\n            timeOk:function(){\r\n                this.getCrowdList();\r\n                this.open=false;\r\n            },\r\n            timeChange:function(){\r\n                $('#picker .ivu-picker-confirm').find('.ivu-btn-primary').attr('disabled',false);\r\n            },\r\n            selectCrowd:function(e){\r\n                if(e.length>5){\r\n                    this.editData.crowdIds =e.slice(0,5);\r\n                }\r\n            },\r\n            save:function(){\r\n                var _vm=this;\r\n                this.$refs['editData'].validate(function(valid){\r\n                    if (valid) {\r\n                        _vm.editData.crowdIds=_vm.editData.crowdIds.join(',');\r\n                        _vm.editData.crowdNames=_vm.editData.crowdName.join(',');\r\n                        axios.post(getUrl(\"marketEvent/saveMarketEvent\"),_vm.editData).then(function(data){\r\n                            if(data.code==0){\r\n                                _vm.$Message.success(\"操作成功\");\r\n                                _vm.backToList();\r\n                                _vm.$parent.reload();\r\n                            }\r\n                        })\r\n                    } else {\r\n                        _vm.$Message.warning(\"操作失败\")\r\n                    }\r\n                })\r\n            }\r\n        },\r\n        mounted:function(){\r\n            var vm=this;\r\n           // this.getCrowdList();\r\n            $('#picker .ivu-input-wrapper').on('click',function () {\r\n                vm.open=true;\r\n                $('#picker .ivu-picker-confirm').find('.ivu-btn-primary').attr('disabled',true);\r\n            });\r\n\r\n        }\r\n    }\r\n</script>\n\n\n// WEBPACK FOOTER //\n// src/pages/market/Add.vue","var normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!../../../node_modules/iview-loader/index.js??ref--0-1!./Add.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!../../../node_modules/iview-loader/index.js??ref--0-1!./Add.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-bd404f00\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":\\\"src\\\",\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!../../../node_modules/iview-loader/index.js??ref--0-1!./Add.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = null\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/market/Add.vue\n// module id = mOn7\n// module chunks = 18","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"new-add\"},[_c('Form',{ref:\"editData\",attrs:{\"model\":_vm.editData,\"rules\":_vm.ruleValidate,\"label-width\":120}},[_c('div',{staticClass:\"panel panel-default\"},[_c('Card',{attrs:{\"dis-hover\":\"\"}},[_c('p',{attrs:{\"slot\":\"title\"},slot:\"title\"},[_vm._v(\"创建营销活动\")]),_vm._v(\" \"),_c('FormItem',{attrs:{\"label\":\"活动名称\",\"prop\":\"eventName\"}},[_c('div',{staticClass:\"groups\"},[_c('Input',{staticClass:\"w-260\",attrs:{\"type\":\"text\",\"placeholder\":\"请输入活动名称\"},model:{value:(_vm.editData.eventName),callback:function ($$v) {_vm.$set(_vm.editData, \"eventName\", $$v)},expression:\"editData.eventName\"}})],1)]),_vm._v(\" \"),_c('FormItem',{attrs:{\"label\":\"活动类型\"}},[_c('div',{staticClass:\"groups\"},[_c('RadioGroup',{model:{value:(_vm.editData.eventType),callback:function ($$v) {_vm.$set(_vm.editData, \"eventType\", $$v)},expression:\"editData.eventType\"}},_vm._l((_vm.channels),function(item){return _c('Radio',{key:item.value,attrs:{\"label\":item.value,\"disabled\":\"\"}},[_vm._v(_vm._s(item.label))])}))],1)]),_vm._v(\" \"),_c('FormItem',{attrs:{\"label\":\"推送日期\",\"prop\":\"dateRange\"}},[_c('div',{staticClass:\"groups\",attrs:{\"id\":\"tip-date\"}},[_c('DatePicker',{attrs:{\"id\":\"picker\",\"confirm\":\"\",\"format\":\"yyyy.MM.dd\",\"options\":_vm.options.dateRange,\"type\":\"daterange\",\"placeholder\":\"请选择日期\",\"open\":_vm.open},on:{\"on-ok\":_vm.timeOk,\"on-clear\":function($event){_vm.open=false},\"on-change\":_vm.timeChange},model:{value:(_vm.editData.dateRange),callback:function ($$v) {_vm.$set(_vm.editData, \"dateRange\", $$v)},expression:\"editData.dateRange\"}})],1)]),_vm._v(\" \"),_c('FormItem',{attrs:{\"label\":\"选择人群\",\"prop\":\"crowdName\"}},[_c('div',{staticClass:\"groups\"},[_c('selection',{attrs:{\"placeholder\":\"请选择人群\",\"filter-placeholder\":\"请输入人群名称\",\"value\":_vm.crowdList,\"multiple\":true,\"clearable\":\"\",\"value-field\":\"crowdId\",\"label-field\":\"crowdName\",\"label-model\":\"editData.crowdName\",\"context\":this},on:{\"on-change\":_vm.selectCrowd},model:{value:(_vm.editData.crowdIds),callback:function ($$v) {_vm.$set(_vm.editData, \"crowdIds\", $$v)},expression:\"editData.crowdIds\"}})],1)]),_vm._v(\" \"),_c('FormItem',{attrs:{\"label\":\"推送时间\",\"prop\":\"pushTime\"}},[_c('div',{staticClass:\"groups\"},[_c('span',[_vm._v(\"每日定时\")]),_vm._v(\" \"),_c('Select',{model:{value:(_vm.editData.pushTime),callback:function ($$v) {_vm.$set(_vm.editData, \"pushTime\", $$v)},expression:\"editData.pushTime\"}},_vm._l((17),function(item,idx){return _c('Option',{key:idx,attrs:{\"value\":idx},domProps:{\"textContent\":_vm._s(idx+8+'点')}})}))],1)]),_vm._v(\" \"),_c('FormItem',{attrs:{\"label\":\"短信内容\",\"prop\":\"content\"}},[_c('div',{staticClass:\"groups\"},[_c('Input',{staticClass:\"message\",attrs:{\"type\":\"textarea\",\"autosize\":{minRows: 4},\"placeholder\":\"请编辑短信内容.....\"},model:{value:(_vm.editData.content),callback:function ($$v) {_vm.$set(_vm.editData, \"content\", $$v)},expression:\"editData.content\"}})],1)])],1),_vm._v(\" \"),_c('div',{staticClass:\"groups\"},[_c('Button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.save}},[_vm._v(\"保存\")]),_vm._v(\" \"),_c('Button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.backToList}},[_vm._v(\"取消\")])],1)],1)])],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-bd404f00\",\"hasScoped\":false,\"transformToRequire\":{\"video\":\"src\",\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./node_modules/iview-loader??ref--0-1!./src/pages/market/Add.vue\n// module id = xbTj\n// module chunks = 18"],"sourceRoot":""}